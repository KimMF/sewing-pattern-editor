<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css">
    <style>
      :focus {
        outline: 3px dotted rgb(38, 132, 132) !important;
        outline-offset: 0 !important;
      }

      .pattern-card:focus-within {
        background-color: hsla(240, 7%, 99%, 1);
      }
    </style>
  </head>
  <body>
    <script src="/sewing-pattern-editor/assets/js/elm.js"></script>
    <script src="/assets/js/elm.js"></script>
    <script>
      var storageKey = "sewing-pattern-editor-storage";
      var cache = JSON.parse(window.localStorage.getItem(storageKey));
      var app = Elm.Main.init({
        flags: {
          windowWidth: window.innerWidth,
          windowHeight: window.innerHeight,
          cache: cache
        }
      });

      app.ports.safeCache.subscribe(function(value) {
        if (value === null) {
          window.localStorage.removeItem(storageKey);
        } else {
          window.localStorage.setItem(storageKey, JSON.stringify(value));
        }

        setTimeout(function() { app.ports.onCacheChange.send(value) }, 0);
      });

      window.addEventListener("storage", function(event) {
        if (event.storageArea === window.localeStorage && event.key === storageKey) {
          app.ports.onCacheChange.send(event.newValue);
        }
      });
    </script>
  </body>
</html>
